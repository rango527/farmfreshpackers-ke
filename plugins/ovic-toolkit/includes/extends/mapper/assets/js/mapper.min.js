!function(t){"use strict";t.fn.OvicRenderPin=function(){var s=t(this),e=s.find(".ovic-pin"),i=s.data("width"),o=s.data("height");e.each(function(){var s=t(this).data("top"),e=t(this).data("left");s.substr&&"%"!=s.substr(-1)&&(s=s/o*100+"px"),e.substr&&"%"!=e.substr(-1)&&(e=e/i*100+"px"),t(this).css({top:s,left:e})})},t.fn.OvicInitPopup=function(){var s=t(this).find(".ovic-pin .action-pin");s.on("click",function(){var s=t(this),e=s.siblings(".ovic-popup");if(e.length){var i=s.closest(".ovic-pin");if(i.hasClass("actived"))return i.removeClass("actived"),void setTimeout(function(){e.removeAttr("style")},300);var o=i.data("position");e.css({transition:"none",width:"",left:""}),setTimeout(function(){e.css({transition:""})}),e.removeClass("remove-redirect right left top bottom"),e.addClass(o);var a=s[0].getBoundingClientRect(),r=(e[0].getBoundingClientRect(),e.width()),c=e.height(),l=t(window).width(),n=!1;if(r>l)e.removeClass("right left top").addClass("bottom"),e.width(l),n=!0;else switch(o){case"right":var v=l-(a.right+r+8);0>v&&(r>a.right?(e.removeClass("right").addClass("bottom"),n=!1):e.removeClass("right").addClass("left"));break;case"left":var d=a.left-r+8;0>d&&(r>a.right?(e.removeClass("left").addClass("bottom"),n=!1):e.removeClass("left").addClass("right"));break;case"top":var p=parseInt(i.css("top"));c>p&&e.removeClass("top").addClass("bottom");break;case"bottom":var h=parseInt(i.css("bottom"));c>h&&e.removeClass("bottom").addClass("top")}if(e.hasClass("top")||e.hasClass("bottom")){e.css("left",0);var f=e.offset();if(f.left<=0)e.css({left:-f.left}),e.addClass("remove-redirect");else{if(n)var m=f.left+l;else var m=f.left+r;if(m>l){var u=l-m;e.css({left:u}),e.addClass("remove-redirect")}else e.css("left","")}}if(t(".content-text").css({"max-height":r-80+"px",overflow:"auto"}),t(".ovic-mapper .ovic-pin .ovic-popup-header h2").css("max-width",r-10),e.hasClass("ovic-image")){var C=e.find(".ovic-popup-header").outerHeight(!0);e.find(".ovic-popup-main").css("height",c-C)}setTimeout(function(){t(".ovic-mapper .ovic-pin.actived").removeClass("actived"),i.addClass("actived")},300)}}),t(".ovic-pin .close-modal").on("click",function(){var s=t(this).closest(".ovic-pin"),e=s.find(".ovic-popup");s.removeClass("actived"),setTimeout(function(){e.removeAttr("style")},300)});var e="blur(2px)",i="grayscale(100%)",o=!1;s.hover(function(){var s=t(this);o=!0,s.closest(".blur").children("img").css("filter",e).css("webkitFilter",e).css("mozFilter",e).css("oFilter",e).css("msFilter",e),s.closest(".gray").children("img").css("filter",i).css("webkitFilter",i).css("mozFilter",i).css("oFilter",i).css("msFilter",i),s.closest(".mask").children(".mask").css("opacity",1)},function(){var s=t(this);o=!1,s.closest(".ovic-mapper").children("img").removeAttr("style"),s.closest(".mask").children(".mask").removeAttr("style")})},window.addEventListener("load",function(s){t(".ovic-mapper").length&&t(".ovic-mapper").each(function(){t(this).OvicRenderPin(),t(this).OvicInitPopup()})},!1)}(window.jQuery);